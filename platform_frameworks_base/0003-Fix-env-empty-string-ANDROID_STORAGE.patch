From 8b7b08f2c0201a78bce0591c20c639132e7563ae Mon Sep 17 00:00:00 2001
From: Raphael Mounier <mounierr07@gmail.com>
Date: Sat, 6 Aug 2022 18:08:36 +0200
Subject: [PATCH 03/55] Fix env empty string - ANDROID_STORAGE

Huawei hi6250 define in init.hi6250.rc ANDROID_STORAGE to "", so check empty string and replace with default path. Apply change for all env directory
---
 core/java/android/os/Environment.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/core/java/android/os/Environment.java b/core/java/android/os/Environment.java
index f6109af55..9d77ce816 100644
--- a/core/java/android/os/Environment.java
+++ b/core/java/android/os/Environment.java
@@ -1617,7 +1617,7 @@ public class Environment {
     private static String getDirectoryPath(
             @NonNull String variableName, @NonNull String defaultPath) {
         String path = getEnvPath(variableName);
-        return prep(path == null ? defaultPath : path);
+        return prep((path == null || path.isEmpty()) ? defaultPath : path);
     }

     /** @hide */
--
2.43.0
